<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-Year3/4101/reading">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.3.1">
<title data-rh="true">reading | Nottes</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://notes.danlee.uk/Year3/4101/reading"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="reading | Nottes"><meta data-rh="true" name="description" content="Chapter 1 - Basic Static Analysis"><meta data-rh="true" property="og:description" content="Chapter 1 - Basic Static Analysis"><link data-rh="true" rel="icon" href="/img/nottsYell.png"><link data-rh="true" rel="canonical" href="https://notes.danlee.uk/Year3/4101/reading"><link data-rh="true" rel="alternate" href="https://notes.danlee.uk/Year3/4101/reading" hreflang="en"><link data-rh="true" rel="alternate" href="https://notes.danlee.uk/Year3/4101/reading" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Nottes RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Nottes Atom Feed">




<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.d5141fb4.css">
<link rel="preload" href="/assets/js/runtime~main.fab43acd.js" as="script">
<link rel="preload" href="/assets/js/main.8bd17781.js" as="script">
</head>
<body class="navigation-with-keyboard" data-theme="light">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top navbarHideable_m1mJ"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/nottsBlue.svg" alt="Nottes Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/nottsYell.svg" alt="Nottes Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Nottes</b></a><a class="navbar__item navbar__link" href="/Year1">Year 1</a><a class="navbar__item navbar__link" href="/Year2/">Year 2</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/Year3/">Year 3</a><a class="navbar__item navbar__link" href="/ITST/">Tech Support</a></div><div class="navbar__items navbar__items--right"><div class="searchBox_ZlJk"><div class="dsla-search-wrapper"><div class="dsla-search-field" data-tags="default,docs-default-current"></div></div></div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd sidebarWithHideableNavbar_wUlq"><a tabindex="-1" class="sidebarLogo_isFc" href="/"><img src="/img/nottsBlue.svg" alt="Nottes Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/nottsYell.svg" alt="Nottes Logo" class="themedImage_ToTc themedImage--dark_i4oU"><b>Nottes</b></a><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/Year3/3006/00">3006</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/Year3/3010/00">3010</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/Year3/3020/00">3020</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/Year3/3021/00">3021</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/Year3/3074/00">3074</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/Year3/3077/00">3077</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/Year3/4101/00">4101</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Year3/4101/00">About Malware</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Year3/4101/01">Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Year3/4101/02">Basic Dynamic Analysis</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Year3/4101/03">Introduction to x86</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Year3/4101/04">Disassembly</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Year3/4101/05">Process of Malware Analysis</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Year3/4101/06">Anti-Disassembly</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Year3/4101/07">Data Encoding</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Year3/4101/08-01">Programs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Year3/4101/08-02">Programs on disk</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Year3/4101/08">Processes 1</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Year3/4101/09">Processes 2</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Year3/4101/10">Malware: Impact and Evolution</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Year3/4101/11">Downloaders and Launchers</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Year3/4101/12">Backdoors</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Year3/4101/13">Credential Stealers</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Year3/4101/14">Persistence</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/Year3/4101/reading">reading</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Year3/4101/revision">revision</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/Year3/">README</a></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">4101</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">reading</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>reading</h1></header><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="chapter-1---basic-static-analysis">Chapter 1 - Basic Static Analysis<a href="#chapter-1---basic-static-analysis" class="hash-link" aria-label="Direct link to Chapter 1 - Basic Static Analysis" title="Direct link to Chapter 1 - Basic Static Analysis">​</a></h2><p>ASCII strings use 1 byte per char, unicode 2
0x00 at the end is the NULL terminator</p><p>Files can be compressed, a wrapper program will be in the program to decompress the packed file
Can use PEiD program to detect the type of packer or compiler employed</p><p>Portable Executable File Format (PE) is used by windows executables. OS loader to manage the wrapped executable code.</p><p>Static linking imports linked libraries into the executable, which makes it harder to decode/analyse</p><p><code>.text</code> - Contains the instructions which the CPU executes
<code>.rdata</code> - Import and export information
<code>.data</code> - Programs global data which is accessible from anywhere in the program
<code>.rsrc</code> - Resources used by the executable that are not considered part of the executable, icons, imgs, strings etc</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="chapter-2---basic-dynamic-analysis">Chapter 2 - Basic Dynamic Analysis<a href="#chapter-2---basic-dynamic-analysis" class="hash-link" aria-label="Direct link to Chapter 2 - Basic Dynamic Analysis" title="Direct link to Chapter 2 - Basic Dynamic Analysis">​</a></h2><p>Procmon captures a lot of data, however it doesnt capture everything. Misses device driver activity of user-mode component talking to a rootkit via device I/O, UI calls.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="chapter-4---crash-course-of-x86-disassembly">Chapter 4 - Crash course of x86 Disassembly<a href="#chapter-4---crash-course-of-x86-disassembly" class="hash-link" aria-label="Direct link to Chapter 4 - Crash course of x86 Disassembly" title="Direct link to Chapter 4 - Crash course of x86 Disassembly">​</a></h2><p>General registers, 32 bits in size, and can be referenced as either 32 or 16 bits in assembly.</p><p><code>EDX</code> - Reference the full 32-bit register
<code>EAX</code>,<code>EBX</code>,<code>ECX</code>,<code>EDX</code> - Can be referenced as 8-bit values using the lowest 8 bits.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="flags">Flags<a href="#flags" class="hash-link" aria-label="Direct link to Flags" title="Direct link to Flags">​</a></h3><p><code>ZF</code> - Zero flag is set when the result of an operation is = 0
<code>CF</code> - Carry flag is set when the result of an operation is too large or too small
<code>SF</code> - Sign flag is set when the result of an operation is negative or cleared when the result is positive
<code>TF</code> - Trap flag is used for debugging</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="the-stack">The Stack<a href="#the-stack" class="hash-link" aria-label="Direct link to The Stack" title="Direct link to The Stack">​</a></h3><p><code>ESP</code> - Stack Pointer
<code>EBP</code> - Base pointer</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="chapter-6">Chapter 6<a href="#chapter-6" class="hash-link" aria-label="Direct link to Chapter 6" title="Direct link to Chapter 6">​</a></h2><p>Local variables would be stored on the stark, whereas global would be stored in memory.
Conditional statements would use <code>jnz</code>
<code>cmp</code> is comparison between to vars</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="recognising-for-loops">Recognising for loops<a href="#recognising-for-loops" class="hash-link" aria-label="Direct link to Recognising for loops" title="Direct link to Recognising for loops">​</a></h3><ul><li>Can be located by the four components</li></ul><ol><li>Initialisation</li><li>Comparison</li><li>Execution instructions</li><li>Increment/decrement</li></ol><p>Items are added right to left</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="chapter-7">Chapter 7<a href="#chapter-7" class="hash-link" aria-label="Direct link to Chapter 7" title="Direct link to Chapter 7">​</a></h2><p><code>DWORD</code>/<code>dw</code> = 32-bit word
<code>WORD</code>/<code>w</code> = 16-bit word
<code>H</code> = Handles. Reference to an object
<code>LP</code> = Long Pointer. Pointer to another type</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="dlls">DLLs<a href="#dlls" class="hash-link" aria-label="Direct link to DLLs" title="Direct link to DLLs">​</a></h3><ul><li>Advantages to using DLLs to contain the malware</li><li>Contain the functionality needed to interact within the OS. </li><li>Might use other dlls for the malware</li></ul><p>Process = Program being executed by windows. Manages own resources
Threads = What the Windows OS executes. Threads are independent sequences of instructions that are executed by the CPU, without having to wait for other threads.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="chapter-11---malware-behaviour">Chapter 11 - Malware Behaviour<a href="#chapter-11---malware-behaviour" class="hash-link" aria-label="Direct link to Chapter 11 - Malware Behaviour" title="Direct link to Chapter 11 - Malware Behaviour">​</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="windows-reverse-shells">Windows Reverse Shells<a href="#windows-reverse-shells" class="hash-link" aria-label="Direct link to Windows Reverse Shells" title="Direct link to Windows Reverse Shells">​</a></h3><p>Two simple malware coding implementations for <code>cmd.exe</code> - basic and multithreaded</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="basic">Basic<a href="#basic" class="hash-link" aria-label="Direct link to Basic" title="Direct link to Basic">​</a></h4><ul><li>Easier to write, works just as well as multithreaded technique. </li><li>Involves call to CreateProcess and the manipulation of the StartupInfo.</li><li>Socket is opened to connect to remote server</li><li>Socket is then tied to the standard streams. </li></ul><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="multithreaded">Multithreaded<a href="#multithreaded" class="hash-link" aria-label="Direct link to Multithreaded" title="Direct link to Multithreaded">​</a></h4><ul><li>Requires socket, two pipes and two threads. </li><li>Uses data encoding</li><li>Used to manipulate or encode the data coming in or going out of the socket. </li></ul><p>Remote administration tool - used to manage computer remotely.
Botnets - Collection of compromised hosts, known as zombies, controlled by a single entity.  Goal is to compromise as many hosts as possible in order to create a large network. </p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="gina-interception">GINA Interception<a href="#gina-interception" class="hash-link" aria-label="Direct link to GINA Interception" title="Direct link to GINA Interception">​</a></h3><p>Windows XP Graphical Identification and Authentication. Malware users intercept this to steal user credentials. Intended to allow legitimate third parties to customise logon process to allow for auth via 3rd party like RFID. Implemented in a DLL</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="hash-dumping">Hash Dumping<a href="#hash-dumping" class="hash-link" aria-label="Direct link to Hash Dumping" title="Direct link to Hash Dumping">​</a></h3><p>Popular way to access system credentials. Could be cracked either offline or through a pass-the-hash attack. PSH and Pwdump are open source, so a lot of malware contain these. Most antivirus programs have signatures for the default compiled versions of these tools, so attackers have to compile their own version.
Pwdump works by performing DLL injection inside the Local Security Authority Subsystem Service</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="key-loggers">Key Loggers<a href="#key-loggers" class="hash-link" aria-label="Direct link to Key Loggers" title="Direct link to Key Loggers">​</a></h3><ul><li>Kernel-based loggers are difficult to detect with user-mode applications. Part of a rootkit, that can act as a keyboard drivers to capture keystrokes, bypassing user-space programs and protections.</li></ul><p>User-based typically use the Windows API, implemented either by hooking or polling. Hooking uses the API to notify the malware a key is pressed. Polling constantly polls the state of the keys.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="appinit_dlls">AppInit_DLLs<a href="#appinit_dlls" class="hash-link" aria-label="Direct link to AppInit_DLLs" title="Direct link to AppInit_DLLs">​</a></h3><ul><li>Malware gains persistence through special registry location called <code>AppInit_DLL</code>.</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="svchost-dlls">SvcHost DLLs<a href="#svchost-dlls" class="hash-link" aria-label="Direct link to SvcHost DLLs" title="Direct link to SvcHost DLLs">​</a></h3><ul><li>Malware will typically not create a new group, since it would be easier to detect. Instead, most malware will add itself to a pre-existing group or overwrite a nonvital service.</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="trojanized-system-binaries">Trojanized System Binaries<a href="#trojanized-system-binaries" class="hash-link" aria-label="Direct link to Trojanized System Binaries" title="Direct link to Trojanized System Binaries">​</a></h3><ul><li>Malware patches bytes of a system binary to force the system to execute the malware the next time the binary is run or loaded.</li><li>Normally done by patching the entry function so it jumps to the malicious code</li><li>Malware is added to empty section so does not impact normal operation. Will function no matter what. Will execute malware then jump back to normal location</li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="chapter-12---covert-malware-launching">Chapter 12 - Covert Malware Launching<a href="#chapter-12---covert-malware-launching" class="hash-link" aria-label="Direct link to Chapter 12 - Covert Malware Launching" title="Direct link to Chapter 12 - Covert Malware Launching">​</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="launchersloader">Launchers/Loader<a href="#launchersloader" class="hash-link" aria-label="Direct link to Launchers/Loader" title="Direct link to Launchers/Loader">​</a></h3><ul><li>Contains the actual malware, such as exe or DLL in its own resource section. </li><li>Does extract an embedded executable or DLL from the resource section</li><li>Uses resource manipulation <code>FindResource</code>, <code>LoadResource</code>, <code>SizeofResource</code></li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="process-injection">Process injection<a href="#process-injection" class="hash-link" aria-label="Direct link to Process injection" title="Direct link to Process injection">​</a></h3><ul><li><code>VirtualAllocEx</code> - allocate space in an external process memory</li><li><code>WriteProcessMemory</code> - can be used to write data to that allocated space</li><li><code>LoadLibrary</code> - Used by DLL injecting</li></ul><p>Three common functions found in direct injection - <code>VirutalAllocEx</code>, <code>WriteProcessMemory</code>, <code>CreateRemoteThread</code>.</p><p>For process replacement - Key to process replacement is creating a process in a <em>suspended state</em>. Process will be in memory, but the primary thread is suspended. </p><p>Hook injection - Malicious code will run whenever a particular message is intercepted, Particular DLL will be loaded in a victims process memory space</p><p>Keylogger is the only one to load into all threads.</p><p>Most malware authors use Detours to add new DLLs to existing binaries on disk</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="apc-asynchronous-procedure-call">APC (Asynchronous Procedure Call)<a href="#apc-asynchronous-procedure-call" class="hash-link" aria-label="Direct link to APC (Asynchronous Procedure Call)" title="Direct link to APC (Asynchronous Procedure Call)">​</a></h3><ul><li>Thread creation requires overhead, more efficient to invoke a function on an existing thread.</li><li>APC injection can be done when function call is <code>WaitForSingleObjectEx</code>, <code>WaitForMultipleObjectsEx</code> and <code>Sleep</code></li><li>APC generated either by user or kernel mode</li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="chapter-13---data-encoding">Chapter 13 - Data Encoding<a href="#chapter-13---data-encoding" class="hash-link" aria-label="Direct link to Chapter 13 - Data Encoding" title="Direct link to Chapter 13 - Data Encoding">​</a></h2><p>Null-preserving single-byte XOR encoding scheme. Two exceptions</p><ul><li>If the plaintext character is NULL or the key itself, then the byte is skipped</li><li>If the plaintext character is neither NULL nor the key, then it is encoded via an XOR with the key</li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="chapter-15---anti-disassembly">Chapter 15 - Anti Disassembly<a href="#chapter-15---anti-disassembly" class="hash-link" aria-label="Direct link to Chapter 15 - Anti Disassembly" title="Direct link to Chapter 15 - Anti Disassembly">​</a></h2><p>Linear Disassembly - Iterates over a block of code, disassembling one instruction at a time linearly without deviating.  Easiest to defeat because they are unable to distinguish between code and data.</p><p>Flow-oriented disassembler - Doesn&#x27;t blindly iterate over a buffer, assuming the data is nothing but instructions packed neatly together. Examines each instruction and builds a list of locations to disassemble</p><p>If appears in red, rather than blue, then anti-disassembly is being used</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/Year3/4101/14"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Persistence</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/Year3/4101/revision"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">revision</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#chapter-1---basic-static-analysis" class="table-of-contents__link toc-highlight">Chapter 1 - Basic Static Analysis</a></li><li><a href="#chapter-2---basic-dynamic-analysis" class="table-of-contents__link toc-highlight">Chapter 2 - Basic Dynamic Analysis</a></li><li><a href="#chapter-4---crash-course-of-x86-disassembly" class="table-of-contents__link toc-highlight">Chapter 4 - Crash course of x86 Disassembly</a><ul><li><a href="#flags" class="table-of-contents__link toc-highlight">Flags</a></li><li><a href="#the-stack" class="table-of-contents__link toc-highlight">The Stack</a></li></ul></li><li><a href="#chapter-6" class="table-of-contents__link toc-highlight">Chapter 6</a><ul><li><a href="#recognising-for-loops" class="table-of-contents__link toc-highlight">Recognising for loops</a></li></ul></li><li><a href="#chapter-7" class="table-of-contents__link toc-highlight">Chapter 7</a><ul><li><a href="#dlls" class="table-of-contents__link toc-highlight">DLLs</a></li></ul></li><li><a href="#chapter-11---malware-behaviour" class="table-of-contents__link toc-highlight">Chapter 11 - Malware Behaviour</a><ul><li><a href="#windows-reverse-shells" class="table-of-contents__link toc-highlight">Windows Reverse Shells</a></li><li><a href="#gina-interception" class="table-of-contents__link toc-highlight">GINA Interception</a></li><li><a href="#hash-dumping" class="table-of-contents__link toc-highlight">Hash Dumping</a></li><li><a href="#key-loggers" class="table-of-contents__link toc-highlight">Key Loggers</a></li><li><a href="#appinit_dlls" class="table-of-contents__link toc-highlight">AppInit_DLLs</a></li><li><a href="#svchost-dlls" class="table-of-contents__link toc-highlight">SvcHost DLLs</a></li><li><a href="#trojanized-system-binaries" class="table-of-contents__link toc-highlight">Trojanized System Binaries</a></li></ul></li><li><a href="#chapter-12---covert-malware-launching" class="table-of-contents__link toc-highlight">Chapter 12 - Covert Malware Launching</a><ul><li><a href="#launchersloader" class="table-of-contents__link toc-highlight">Launchers/Loader</a></li><li><a href="#process-injection" class="table-of-contents__link toc-highlight">Process injection</a></li><li><a href="#apc-asynchronous-procedure-call" class="table-of-contents__link toc-highlight">APC (Asynchronous Procedure Call)</a></li></ul></li><li><a href="#chapter-13---data-encoding" class="table-of-contents__link toc-highlight">Chapter 13 - Data Encoding</a></li><li><a href="#chapter-15---anti-disassembly" class="table-of-contents__link toc-highlight">Chapter 15 - Anti Disassembly</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">a Dan Lee creations. 
 2025©</div></div></div></footer></div>
<script src="/assets/js/runtime~main.fab43acd.js"></script>
<script src="/assets/js/main.8bd17781.js"></script>
</body>
</html>