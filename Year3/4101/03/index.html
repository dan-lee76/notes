<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-Year3/4101/03">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.3.1">
<title data-rh="true">Introduction to x86 | Nottes</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://notes.danlee.uk/Year3/4101/03"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Introduction to x86 | Nottes"><meta data-rh="true" name="description" content="Introduction"><meta data-rh="true" property="og:description" content="Introduction"><link data-rh="true" rel="icon" href="/img/nottsYell.png"><link data-rh="true" rel="canonical" href="https://notes.danlee.uk/Year3/4101/03"><link data-rh="true" rel="alternate" href="https://notes.danlee.uk/Year3/4101/03" hreflang="en"><link data-rh="true" rel="alternate" href="https://notes.danlee.uk/Year3/4101/03" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Nottes RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Nottes Atom Feed">




<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.d5141fb4.css">
<link rel="preload" href="/assets/js/runtime~main.a06f3160.js" as="script">
<link rel="preload" href="/assets/js/main.0f59ae22.js" as="script">
</head>
<body class="navigation-with-keyboard" data-theme="light">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top navbarHideable_m1mJ"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/nottsBlue.svg" alt="Nottes Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/nottsYell.svg" alt="Nottes Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Nottes</b></a><a class="navbar__item navbar__link" href="/Year1">Year 1</a><a class="navbar__item navbar__link" href="/Year2/">Year 2</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/Year3/">Year 3</a><a class="navbar__item navbar__link" href="/ITST/">Tech Support</a></div><div class="navbar__items navbar__items--right"><div class="searchBox_ZlJk"><div class="dsla-search-wrapper"><div class="dsla-search-field" data-tags="default,docs-default-current"></div></div></div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd sidebarWithHideableNavbar_wUlq"><a tabindex="-1" class="sidebarLogo_isFc" href="/"><img src="/img/nottsBlue.svg" alt="Nottes Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/nottsYell.svg" alt="Nottes Logo" class="themedImage_ToTc themedImage--dark_i4oU"><b>Nottes</b></a><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/Year3/3006/00">3006</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/Year3/3010/00">3010</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/Year3/3020/00">3020</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/Year3/3021/00">3021</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/Year3/3074/00">3074</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/Year3/3077/00">3077</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/Year3/4101/00">4101</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Year3/4101/00">About Malware</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Year3/4101/01">Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Year3/4101/02">Basic Dynamic Analysis</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/Year3/4101/03">Introduction to x86</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Year3/4101/04">Disassembly</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Year3/4101/05">Process of Malware Analysis</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Year3/4101/06">Anti-Disassembly</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Year3/4101/07">Data Encoding</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Year3/4101/08-01">Programs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Year3/4101/08-02">Programs on disk</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Year3/4101/08">Processes 1</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Year3/4101/09">Processes 2</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Year3/4101/10">Malware: Impact and Evolution</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Year3/4101/11">Downloaders and Launchers</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Year3/4101/12">Backdoors</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Year3/4101/13">Credential Stealers</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Year3/4101/reading">reading</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/Year3/">README</a></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">4101</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Introduction to x86</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Introduction to x86</h1><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="introduction">Introduction<a href="#introduction" class="hash-link" aria-label="Direct link to Introduction" title="Direct link to Introduction">​</a></h2><p>Can look into the assembly and be able to decode the program into what it does. However doesn&#x27;t work in the real world as x86 adds on a lot more. Various ways to jump to different areas within the program.</p><p>SMID make it quick to process images</p><p>Basic analysis helps us triage, but to fully understand how it works we need to disassemble it. Reading programs rather than writing them.
Disassembling - Reverse-engineering the malwares code to understand what it does</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="disassembly">Disassembly<a href="#disassembly" class="hash-link" aria-label="Direct link to Disassembly" title="Direct link to Disassembly">​</a></h3><ul><li>Turning the opcodes back into the assembly language mnemonics. Easier to get a computer doing it</li><li>Need to generate labels so we know where any branches and subroutine calls go to</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="assembly-syntax">Assembly Syntax<a href="#assembly-syntax" class="hash-link" aria-label="Direct link to Assembly Syntax" title="Direct link to Assembly Syntax">​</a></h3><p>Two types of syntax for x86, intel and AT&amp;T.
Usual to use Intel for windows world and AT&amp;T for Unix world.
Intel has two operands. Instruction then two operand</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="machine-code">Machine Code<a href="#machine-code" class="hash-link" aria-label="Direct link to Machine Code" title="Direct link to Machine Code">​</a></h3><p>Machine code is what the CPU executes and is represented as a series of binary opcodes.
Types of machine code consists of:</p><ul><li>Basic operations - Maths, comparison, Boolean algebra</li><li>Memory access</li><li>Flow control (jumps and branches)</li><li>Subroutines</li></ul><p>High level languages have more features, however, the compiler will generate the same set of machine code instructions each time.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="history-of-x86">History of x86<a href="#history-of-x86" class="hash-link" aria-label="Direct link to History of x86" title="Direct link to History of x86">​</a></h2><p>Majority of malware written for x86 as most popular
CISC CPU and Little endian</p><blockquote><p>It is well-know that the x86 instruction set is baroque, overcomplicated, and redundantly redundant.</p></blockquote><p>8080 - First used in a PC, 8-bit data bus version of the 8086. 16-bit CPU
80286 - added protected mode
80386 - 32-bit version
AMD Opteron - 64-bit version</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="x86-memory-model">x86 Memory Model<a href="#x86-memory-model" class="hash-link" aria-label="Direct link to x86 Memory Model" title="Direct link to x86 Memory Model">​</a></h3><p>Segmented Memory - Address accessed built up from the value in a segment register, and the address specified in the instruction
These days, most OS use a flat memory model</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="x86-registers">x86 Registers<a href="#x86-registers" class="hash-link" aria-label="Direct link to x86 Registers" title="Direct link to x86 Registers">​</a></h3><ul><li>Eight 32-bit general purpose registers</li><li>Status Register - EFLAGS</li><li>Instruction Pointer - EIP</li><li>ESP - Stack pointer</li><li>EBP - Base of the stack pointer</li></ul><p><img loading="lazy" src="data:image/png;base64,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EomoXbu2GjdunF17KCa1tm7daurce+8Ek5PT0uTktDSXXz7M5t98843Nc3JamlWrVtnetddeZ/Nf/OI2my9evDhtT01Nje398Ifn2XzatGk2f/nll23es+dxNjfGmF69etve7373O5s/8sgjNj/77HNsvn///rSv/+GHH9peScmdNv/Zz662+Zdffpm2Z+PGjbZ35ZU/tfkvf3m3zefPn2/zvLy2NjfGmEGDzrS9WbNm2fy5556z+ckn90nb061bd9t77bXXbP6rX/2HzS+88CKb79ixI+02L1++3PZuuunfbD52bLHNE4lE2p7Kykrb+/GPL7H55MmTbf7mm2/avEuXo21ujDGnnNLX9mbPnm3zX//61zbv339A2p727TvYXjwet/k/8hisrq62veZyDK5fvz7t3/OBippEMpohd6okZhLxSMY8Vp5hvWSkiIn5xiSSCWP8mIkE+vX11FNP/a+Pwfvv5xhM9bceg8aYtK//jzgGjfNzsE2bPJubv/PPwf/4j4P9HKxKu81/z5+DBz8Gu9jc/J2PwQkTGv4Y/Pbbb40xxnTu3DnwbzlDpQedOnUyXbp0cRdRFNVk68gHCd8Yk0gbGiIm5idM1F1r1/smVnKQjymKarJ11FFHma5du5oWLVoEehkqEFAU1SwqahL2/xopMp05KD+w0o9HTDSZtjjzYFC7vm6PJBOJ+zZLH0YoimrOFXiOBAAAwJEKvGoDAADgSDFIAACA0BgkAABAaP8fEbFhkqCSmPQAAAAASUVORK5CYII=" width="530" height="298" class="img_ev3q">
<code>al</code> = 8bit
<code>ax</code> = 16bit
<code>eax</code> = 32bit
<code>rax</code> = 64bit</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="cisc-architecture">CISC Architecture<a href="#cisc-architecture" class="hash-link" aria-label="Direct link to CISC Architecture" title="Direct link to CISC Architecture">​</a></h3><ul><li>x86 has a register-memory architecture - instructions can operate on a register or directly on memory</li><li>Often more than one way to do things</li><li>Lots of instructions for doing interesting things</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="x86-opcode-structure">x86 Opcode Structure<a href="#x86-opcode-structure" class="hash-link" aria-label="Direct link to x86 Opcode Structure" title="Direct link to x86 Opcode Structure">​</a></h3><ul><li>Opcodes can vary in length from 1-15 bytes long</li><li>Difficult to fetch from memory, since length is not known till you are three or four bytes into decoding it</li><li><code>eip</code> points to the first byte of the next instruction, updates as instructions <code>read</code></li></ul><p>When storing memory, will do it as LSB
Can do everything using the <code>move</code> operand</p><p>Instructions can run in memory or on the registers</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="function-calls">Function Calls<a href="#function-calls" class="hash-link" aria-label="Direct link to Function Calls" title="Direct link to Function Calls">​</a></h2><ul><li>x86 supports calling subroutines</li><li>Does this using the <code>call</code> instruction</li><li>Address of next instruction can be specified<ul><li>Relative (to the current instruction)</li><li>Absolute</li><li>Indirectly (the address appointed to by...)</li></ul></li><li>Once the destination address is calculated <code>call</code> will then<ul><li>Current instruction pointer (<code>eip</code>/<code>rip</code>) pushed onto the stack</li><li>Instruction pointer set to address of start of subroutine</li></ul></li><li>Can return from a subroutine from the stack<ul><li>Pops the old instruction pointer from the stack</li><li>Places it into <code>eip</code>/<code>rip</code> so next instruction carries on after <code>call</code></li><li>Optionally, can then add an offset to the stack pointer</li></ul></li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="the-stack">The Stack<a href="#the-stack" class="hash-link" aria-label="Direct link to The Stack" title="Direct link to The Stack">​</a></h3><ul><li><code>ret</code> - fetches the return address off the stack</li><li>Stack is also used for local variables and arrays</li><li>If malware can control where <code>ret</code> returns to, it can cause a program to do &#x27;something new&#x27;</li><li>Often used as a vector for initially executing malware code</li><li>Two mechanisms used<ul><li>Cause the stack to be overwritten with the code we want to execute</li><li>Return-oriented programming</li></ul></li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="function-call-arguments">Function Call Arguments<a href="#function-call-arguments" class="hash-link" aria-label="Direct link to Function Call Arguments" title="Direct link to Function Call Arguments">​</a></h3><ul><li>Place arguments on the stack</li><li>Caller and callee need to agree on the arguments passed</li><li>Return values passed in <code>eax</code>/<code>rax</code></li></ul><p><img loading="lazy" src="/assets/images/4101_03_01-07c72501ac0a6da96a9c380c01ddb696.png" width="610" height="319" class="img_ev3q"></p><p>Most C compilers will compile a function prologue at the start of the program</p><ul><li><p>Pushed the current value of <code>ebp</code></p></li><li><p>Sets <code>ebp</code> to the value of <code>esp</code></p></li><li><p>Allocate space for local variables on the stack (using <code>sub</code>)</p></li><li><p>Preserve registers</p></li><li><p>At the end of the function, an equivalent epilogue is generated to restore the stack/registers</p></li><li><p>Side-effect of this is that <code>ebp</code> can be used to trace back up the call stack</p></li></ul></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/Year3/4101/02"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Basic Dynamic Analysis</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/Year3/4101/04"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Disassembly</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#introduction" class="table-of-contents__link toc-highlight">Introduction</a><ul><li><a href="#disassembly" class="table-of-contents__link toc-highlight">Disassembly</a></li><li><a href="#assembly-syntax" class="table-of-contents__link toc-highlight">Assembly Syntax</a></li><li><a href="#machine-code" class="table-of-contents__link toc-highlight">Machine Code</a></li></ul></li><li><a href="#history-of-x86" class="table-of-contents__link toc-highlight">History of x86</a><ul><li><a href="#x86-memory-model" class="table-of-contents__link toc-highlight">x86 Memory Model</a></li><li><a href="#x86-registers" class="table-of-contents__link toc-highlight">x86 Registers</a></li><li><a href="#cisc-architecture" class="table-of-contents__link toc-highlight">CISC Architecture</a></li><li><a href="#x86-opcode-structure" class="table-of-contents__link toc-highlight">x86 Opcode Structure</a></li></ul></li><li><a href="#function-calls" class="table-of-contents__link toc-highlight">Function Calls</a><ul><li><a href="#the-stack" class="table-of-contents__link toc-highlight">The Stack</a></li><li><a href="#function-call-arguments" class="table-of-contents__link toc-highlight">Function Call Arguments</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">a Dan Lee creations. 
 2025©</div></div></div></footer></div>
<script src="/assets/js/runtime~main.a06f3160.js"></script>
<script src="/assets/js/main.0f59ae22.js"></script>
</body>
</html>